<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>No Objection Certificate - {{ company_name }}</title>
<style>
  @page { size: A4; margin: 2.5cm; }
  body { font-family: 'Helvetica', 'Arial', sans-serif; font-size: 11pt; line-height: 1.6; color: #222; }
  h1 { text-align: center; font-size: 18pt; margin-bottom: 5px; color: #c0392b; }
  h2 { font-size: 13pt; border-bottom: 1px solid #ccc; padding-bottom: 4px; margin-top: 20px; }
  .header { text-align: center; margin-bottom: 30px; }
  .header p { margin: 2px 0; font-size: 9pt; color: #666; }
  .field { margin: 6px 0; }
  .field strong { display: inline-block; width: 160px; }
  table { width: 100%; border-collapse: collapse; margin: 10px 0; }
  td, th { border: 1px solid #ddd; padding: 6px 10px; font-size: 10pt; }
  th { background: #f5f5f5; text-align: left; }
  .signatures { margin-top: 60px; display: flex; justify-content: space-between; }
  .sig-block { width: 45%; }
  .sig-line { border-top: 1px solid #333; margin-top: 60px; padding-top: 5px; }
  .footer { margin-top: 40px; font-size: 8pt; color: #999; text-align: center; }
  .cert-box { border: 3px solid #27ae60; padding: 20px; margin: 30px 0; text-align: center; background: #f0fdf4; }
  .clause { margin: 15px 0; text-align: justify; }
  ul { margin: 10px 0; }
  li { margin: 8px 0; }
</style>
</head>
<body>

<div class="header">
  <h1>{{ company_name }}</h1>
  <p>Registration No: {{ company_reg }}</p>
  <p>{{ company_address }}</p>
</div>

<div class="cert-box">
  <h1 style="font-size: 18pt; color: #27ae60;">NO OBJECTION CERTIFICATE</h1>
</div>

<p style="text-align: center; font-size: 10pt; color: #666;">Ref: {{ noc_ref }} | Date: {{ generated_date }}</p>

<h2>Certificate Details</h2>
<div class="field"><strong>Certificate Type:</strong> {{ certificate_type }}</div>
<div class="field"><strong>Employee Name:</strong> {{ employee_name }}</div>
<div class="field"><strong>Employee ID:</strong> {{ employee_id }}</div>
<div class="field"><strong>Position:</strong> {{ position }}</div>
<div class="field"><strong>Department:</strong> {{ department }}</div>

<h2>Company Certification</h2>

<p class="clause">This is to certify that {{ employee_name }} (NRIC/Passport: {{ nric }}) is/was employed with {{ company_name }} from {{ start_date }} to {{ end_date }}.</p>

<div class="field"><strong>Employment Status:</strong> {{ employment_status }}</div>
<div class="field"><strong>Last Position Held:</strong> {{ last_position }}</div>
<div class="field"><strong>Last Drawn Salary:</strong> {{ currency }} {{ last_salary }}</div>

<h2>No Objection Statement</h2>

<p class="clause">{{ company_name }} has <strong>NO OBJECTION</strong> to:</p>

{% if certificate_type == 'Visa Application' %}
<ul>
  <li>Employee applying for visa/travel documents</li>
  <li>Employee traveling for {{ purpose }}</li>
  <li>Employee's passport application/renewal</li>
</ul>
{% elif certificate_type == 'Loan/Finance' %}
<ul>
  <li>Employee applying for loans/financing</li>
  <li>Financial institutions considering employee's credit worthiness</li>
  <li>Employee's salary verification for {{ purpose }}</li>
</ul>
{% elif certificate_type == 'Driving License' %}
<ul>
  <li>Employee applying for driving license</li>
  <li>Employee's employment verification for license application</li>
</ul>
{% elif certificate_type == 'Moving Abroad' %}
<ul>
  <li>Employee relocating abroad</li>
  <li>Employee's intention to work overseas</li>
  <li>Release of employee from current employment</li>
</ul>
{% else %}
<ul>
  <li>{{ purpose }}</li>
</ul>
{% endif %}

<h2>Verification</h2>
<p>This certificate is issued upon the employee's request for {{ purpose }}. We confirm that the information provided above is true and accurate as per our records.</p>

<div class="field"><strong>Issued By:</strong> {{ issuer_name }}</div>
<div class="field"><strong>Designation:</strong> {{ issuer_designation }}</div>

<div class="clause">
  <p>This certificate is valid for a period of {{ validity_period }}. The Company reserves the right to withdraw this certificate if any discrepancies are found.</p>
</div>

<table style="border: none; margin-top: 50px;">
  <tr style="border: none;">
    <td style="border: none; width: 50%; vertical-align: top;">
      <p><strong>Authorized Signature</strong></p>
      <div style="margin-top: 60px; border-top: 1px solid #333; width: 200px; padding-top: 5px;">
        <p>{{ hr_name }}</p>
        <p>Human Resources Manager</p>
        <p>{{ company_name }}</p>
        <p>Date: _______________</p>
      </div>
    </td>
    <td style="border: none; width: 50%; vertical-align: top;">
      <p><strong>Company Stamp</strong></p>
      <div style="margin-top: 60px; border: 2px solid #333; width: 150px; height: 80px; display: flex; align-items: center; justify-content: center;">
        <p style="color: #999;">[Company Seal]</p>
      </div>
    </td>
  </tr>
</table>

<div class="footer">
  <p>This document was generated by Deriv HR Platform.</p>
  <p>{{ company_name }} | {{ company_address }}</p>
  <p>For verification, contact HR Department: {{ hr_contact }}</p>
</div>

</body>
</html>
